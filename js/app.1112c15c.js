webpackJsonp([1],{"+VGo":function(t,e){},0:function(t,e,a){t.exports=a("NHnr")},"0xcP":function(t,e){},"1ASG":function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("/5sW"),i=a("NYxO"),r=a("Biqn"),s=a.n(r),o=a("vwbq"),l={name:"TripHeader",created:function(){},computed:s()({},Object(i["c"])(["user"])),methods:s()({},Object(i["b"])(["setShowNewTripDialog","setShowLoadTripDialog","setShowPlanDialog","setShowDestDialog"]),{signin:function(){this.googleSignin()},signout:function(){this.googleSignout()}})},c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"header flex-row",staticStyle:{padding:"0.25rem","justify-content":"left",background:"none"}},[a("h5",{staticStyle:{flex:"2","text-align":"left"}},[t._v(" Trip Flow "),a("span",{staticStyle:{"font-size":"50%"}},[t._v(t._s(t.user.name))])]),a("div",{staticClass:"flex-row",staticStyle:{flex:"1"}},[a("button",{staticClass:"btn btn-sm btn-info",on:{click:function(e){t.setShowDestDialog(!0)}}},[t._v("New Destination")]),a("button",{staticClass:"btn btn-sm btn-info",on:{click:function(e){t.setShowPlanDialog(!0)}}},[t._v("New Plan")]),a("button",{staticClass:"btn btn-sm btn-info",on:{click:function(e){t.setShowNewTripDialog(!0)}}},[t._v("New Trip")]),a("button",{staticClass:"btn btn-sm btn-info",on:{click:function(e){t.setShowLoadTripDialog(!0)}}},[t._v("Load Trip")]),!1===t.user.loggedIn?a("button",{staticClass:"btn btn-sm btn-primary",on:{click:function(e){t.signin()}}},[t._v("Sign in ")]):t._e(),!0===t.user.loggedIn?a("button",{staticClass:"btn btn-sm btn-primary",on:{click:function(e){t.signout()}}},[t._v("Sign out ")]):t._e()])])},u=[],d=a("XyMi");function p(t){a("1ASG")}var h=!1,m=p,f=null,v=null,g=Object(d["a"])(l,c,u,h,m,f,v),w=g.exports,b=(a("EuXz"),a("Z60a")),y=a.n(b),P=a("C9uT"),S=a.n(P),D={apiKey:"AIzaSyDFqeomnCXYFfuIj3iSf5NpHBgRDUXGB4k",authDomain:"tripflow-1509338122882.firebaseapp.com",databaseURL:"https://tripflow-1509338122882.firebaseio.com/"};firebase.initializeApp(D);var C=firebase.database(),x=(new firebase.auth.GoogleAuthProvider,function(){function t(){y()(this,t)}return S()(t,null,[{key:"readDB",value:function(t){return C.ref(t).once("value")}},{key:"writeDB",value:function(t,e){return C.ref(t).set(e)}}]),t}());var k={name:"TripNew",data:function(){return{name:""}},computed:s()({},Object(i["c"])(["showNewTripDialog","trip"])),methods:s()({},Object(i["b"])(["setShowNewTripDialog"]),{save:function(){this.trip.name=this.name,x.writeDB("/Trip/"+this.name,this.trip.toObj()),this.setShowNewTripDialog(!1)},cancel:function(){this.setShowNewTripDialog(!1)}})},T=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal",class:{show:t.showNewTripDialog},staticStyle:{opacity:"0.9"}},[a("div",{staticClass:"modal-dialog modal-lg"},[a("div",{staticClass:"modal-content"},[t._m(0),a("div",{staticClass:"modal-body"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.name,expression:"name"}],attrs:{type:"text",placeholder:"Trip name"},domProps:{value:t.name},on:{input:function(e){e.target.composing||(t.name=e.target.value)}}})]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){t.save()}}},[t._v("Save")]),a("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){t.cancel()}}},[t._v("Cancel")])])])])])},I=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("strong",[t._v("Add Trip")])])}],O=!1,E=null,N=null,j=null,L=Object(d["a"])(k,T,I,O,E,N,j),$=L.exports,A=(a("y9m4"),a("fx22"),a("WpTh"),function(){function t(){y()(this,t),this.name="",this.plans=[],this.places=[],this.updated=0,this.view="summary"}return S()(t,[{key:"addPlan",value:function(t){this.plans.push(t)}},{key:"addPlace",value:function(t){this.places.push(t)}},{key:"findPlace",value:function(t){var e=_.find(this.places,function(e){return e.placeId===t});return e||{}}},{key:"maxLength",value:function(){var t=this;return _.max(this.plans.map(function(e){var a=t.listPlan(e);return _.sum(a.map(function(t){return t.data.duration}))}))}},{key:"dateFormat",value:function(t){return!1===_.isNumber(t)?"":d3.timeFormat("%Y-%m-%d %I:%M:%S %p")(+t)}},{key:"listPlan",value:function(t){for(var e=[],a=0;a<t.itineraries.length;a++)e.push({type:"itineraries",data:t.itineraries[a]}),a<t.travels.length&&e.push({type:"travels",data:t.travels[a]});return e}},{key:"load",value:function(t){var e=JSON.parse(t);this.loadJSON(e)}},{key:"loadJSON",value:function(t){this.name=t.name||"",this.places=t.places||[],this.plans=t.plans||[],this.updated=t.updated||"",this.sanitize()}},{key:"sanitize",value:function(){0!==this.plans.length&&this.plans.forEach(function(t){t.itineraries.forEach(function(t){t.duration=+t.duration}),t.travels.forEach(function(t){t.duration=+t.duration})})}},{key:"toObj",value:function(){return this.sanitize(),{name:this.name,places:this.places.map(function(t){return t.placeId}),plans:this.plans,updated:(new Date).getTime()}}}]),t}()),B={name:"TripLoad",data:function(){return{trips:[]}},created:function(){var t=this;x.readDB("/Trip").then(function(e){var a=Object.keys(e.val());a.forEach(function(e){t.trips.push(e)})})},computed:s()({},Object(i["c"])(["showLoadTripDialog"])),methods:s()({},Object(i["b"])(["setShowLoadTripDialog","getPlaceDetail","setTrip"]),{load:function(t){var e=this,a="/Trip/"+t;x.readDB(a).then(function(t){if(null!==t.val()){var a=new A;a.loadJSON(t.val());var n=[];a.places.forEach(function(t){n.push(e.getPlaceDetail(t))}),Promise.all(n).then(function(t){a.places=t,e.setTrip(a),e.setShowLoadTripDialog(!1)})}})},cancel:function(){this.setShowLoadTripDialog(!1)}})},M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal",class:{show:t.showLoadTripDialog},staticStyle:{opacity:"0.9"}},[a("div",{staticClass:"modal-dialog modal-lg"},[a("div",{staticClass:"modal-content"},[t._m(0),a("div",{staticClass:"modal-body"},[a("table",{staticClass:"table table-hover"},[a("tbody",t._l(t.trips,function(e,n){return a("tr",{key:n,staticStyle:{cursor:"pointer"},on:{click:function(a){t.load(e)}}},[a("td",[t._v(t._s(e))])])}))])]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){t.cancel()}}},[t._v("Cancel")])])])])])},U=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("strong",[t._v("Load Trip ")])])}],z=!1,F=null,H=null,R=null,G=Object(d["a"])(B,M,U,z,F,H,R),J=G.exports;function W(t,e,a){var n;return function(){var i=this,r=arguments,s=function(){n=null,a||t.apply(i,r)},o=a&&!n;clearTimeout(n),n=setTimeout(s,e),o&&t.apply(i,r)}}var q={name:"TripDest",data:function(){return{searchStrModel:"",searchCandidates:[]}},computed:s()({},Object(i["c"])(["trip","searchStr","showDestDialog","autocompleteService"])),methods:s()({},Object(i["b"])(["setSearchStr","setShowDestDialog","getPlaceDetail"]),{cancel:function(){this.setShowDestDialog(!1)},select:function(t){this.trip.addPlace(t),this.searchStrModel=""},predict:W(function(){var t=this;this.autocompleteService.getPlacePredictions({input:this.searchStr,types:["(cities)"]},function(e){if(e&&null!==e){var a=[];e.forEach(function(e){e.place_id&&a.push(t.getPlaceDetail(e.place_id))}),0!==a.length&&Promise.all(a).then(function(e){t.searchCandidates=[],e.forEach(function(e){null!==e&&t.searchCandidates.push(e)})})}})},800)}),watch:{searchStr:function(){this.searchStr.length<3?this.searchCandidates=[]:this.predict()},searchStrModel:function(){this.setSearchStr(this.searchStrModel)}}},X=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal",class:{show:t.showDestDialog},staticStyle:{opacity:"0.9"}},[a("div",{staticClass:"modal-dialog modal-lg"},[a("div",{staticClass:"modal-content"},[t._m(0),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"flex-col"},[a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.searchStrModel,expression:"searchStrModel"}],attrs:{type:"text",placeholder:"Search"},domProps:{value:t.searchStrModel},on:{input:function(e){e.target.composing||(t.searchStrModel=e.target.value)}}}),a("br")]),a("div",t._l(t.searchCandidates,function(e,n){return a("div",{key:n,staticClass:"destination-card",staticStyle:{display:"inline-block"},on:{click:function(a){t.select(e)}}},[t._v("\n              "+t._s(e.formatted_address)),a("br"),e.photos?a("div",[e.photos[0]?a("img",{attrs:{src:e.photos[0].getUrl({maxHeight:65})}}):t._e(),e.photos[1]?a("img",{attrs:{src:e.photos[1].getUrl({maxHeight:65})}}):t._e(),e.photos[2]?a("img",{attrs:{src:e.photos[2].getUrl({maxHeight:65})}}):t._e()]):t._e()])}))])]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){t.cancel()}}},[t._v("Cancel")])])])])])},Y=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("strong",[t._v("Add/Edit Destination")])])}],V=!1,K=null,Z=null,Q=null,tt=Object(d["a"])(q,X,Y,V,K,Z,Q),et=tt.exports,at=(a("U6qc"),a("M4fF")),nt=a.n(at),it={name:"trip-summary",filters:{formatDate:function(t){return!1===nt.a.isNumber(t)?"":o["e"]("%Y-%m-%d %I:%M:%S %p")(+t)}},computed:s()({},Object(i["c"])(["trip","currentPlan","currentPlanIdx"])),methods:s()({},Object(i["b"])(["setShowPlanDialog","setCurrentPlan","setCurrentPlanIdx"]),{listPlan:function(t){return this.trip.listPlan(t)},findPlace:function(t){return this.trip.findPlace(t)},switchTo:function(t){this.trip.view=t},show:function(t,e){this.setCurrentPlan(t),this.setCurrentPlanIdx(e)},isPlaceUsed:function(t){var e=nt.a.flatten(this.trip.plans.map(function(t){return t.itineraries.map(function(t){return t.placeId})}));return e.indexOf(t)>=0},deletePlace:function(t){if(null!==t){var e=nt.a.findIndex(this.trip.places,function(e){return e.placeId===t});-1!==e&&this.trip.places.splice(e,1),x.writeDB("/Trip/"+this.trip.name,this.trip.toObj())}},editPlan:function(){this.setShowPlanDialog(!0)},deletePlan:function(){this.currentPlanIdx>-1&&(this.trip.plans.splice(this.currentPlanIdx,1),this.setCurrentPlan(null),this.setCurrentPlanIdx(-1),x.writeDB("/Trip/"+this.trip.name,this.trip.toObj()))}})},rt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{width:"50%",height:"99%"},attrs:{id:"summary"}},[a("ul",{staticClass:"nav nav-tabs"},[a("li",{staticClass:"nav-item",on:{click:function(e){t.switchTo("summary")}}},[a("a",{staticClass:"nav-link",class:{active:"summary"===t.trip.view},attrs:{href:"#"}},[t._v("Summary")])]),a("li",{staticClass:"nav-item",on:{click:function(e){t.switchTo("plans")}}},[a("a",{staticClass:"nav-link",class:{active:"plans"===t.trip.view},attrs:{href:"#"}},[t._v("Plans ")])]),a("li",{staticClass:"nav-item",on:{click:function(e){t.switchTo("destinations")}}},[a("a",{staticClass:"nav-link",class:{active:"destinations"===t.trip.view},attrs:{href:"#"}},[t._v("Destinations")])])]),"summary"===t.trip.view?a("div",{staticStyle:{padding:"0.5rem"}},[a("table",{staticClass:"table"},[a("tbody",[a("tr",[a("td",{attrs:{colspan:"2"}},[a("strong",[t._v(t._s(t.trip.name))])])]),a("tr",[a("td",[t._v("Total destinations")]),a("td",[t._v(t._s(t.trip.places.length))])]),t._m(0),a("tr",[a("td",[t._v("Number of plans")]),a("td",[t._v(t._s(t.trip.plans.length))])]),a("tr",[a("td",[t._v("Last updated")]),a("td",[t._v(t._s(t._f("formatDate")(t.trip.updated)))])]),t._m(1)])])]):t._e(),"plans"===t.trip.view?a("div",{staticStyle:{padding:"0.5rem"}},[0===t.trip.plans.length?a("div",[t._v("\n      Click on "),t._m(2),t._v(" to add a new trip plan.\n    ")]):t._e(),a("div",{staticClass:"flex-row"},[a("div",{staticStyle:{"max-height":"25rem","overflow-y":"scroll"}},t._l(t.trip.plans,function(e,n){return a("div",{key:n,staticClass:"plan-card",class:{active:t.currentPlan&&t.currentPlan.name===e.name},on:{click:function(a){t.show(e,n)}}},[t._v("\n          "+t._s(e.name)+" "),a("br"),a("em",[t._v(t._s(e.itineraries.length)+" destinations")]),a("br")])})),t.currentPlan?a("div",{staticStyle:{"margin-left":"0.5rem","padding-left":"1.0rem","border-left":"1px solid #ddd",flex:"1"}},[a("div",{staticClass:"flex-row"},[a("button",{staticClass:"btn btn-sm btn-primary",on:{click:function(e){t.editPlan()}}},[t._v("Edit")]),t._v("\n           \n          "),a("button",{staticClass:"btn btn-sm btn-danger",on:{click:function(e){t.deletePlan()}}},[t._v("Delete")])]),a("table",{staticClass:"table",staticStyle:{"margin-top":"0.5rem"}},[a("tbody",t._l(t.listPlan(t.currentPlan),function(e,n){return a("tr",{key:n},[a("td",{staticStyle:{padding:"0",position:"relative",border:"0",width:"25px"}},[a("div",{staticStyle:{position:"absolute",top:"0",left:"9px",width:"2px",height:"100%",background:"#AAA"}}),"itineraries"===e.type?a("div",{staticStyle:{position:"absolute",left:"0px",width:"20px",height:"20px",background:"#EEE",border:"2px solid #AAA","border-radius":"50%"}}):t._e()]),"itineraries"===e.type?a("td",[t._v(t._s(t.findPlace(e.data.placeId).name))]):t._e(),"travels"===e.type?a("td",{staticStyle:{"text-align":"center"}},[a("em",[t._v("...Travel...")])]):t._e(),a("td",[t._v(t._s(e.data.duration))])])}))])]):t._e()])]):t._e(),"destinations"===t.trip.view?a("div",{staticStyle:{padding:"0.5rem","max-height":"25rem","overflow-y":"scroll"}},[0===t.trip.places.length?a("div",[t._v("\n      Click on "),t._m(3),t._v(" to add destinations to your trip.\n    ")]):t._e(),"destinations"===t.trip.view?a("table",{staticClass:"table"},[a("tbody",t._l(t.trip.places,function(e,n){return a("tr",{key:n},[a("td",[t._v("\n            "+t._s(e.name)+"\n          ")]),a("td",[e.photos?a("div",[e.photos[0]?a("img",{attrs:{src:e.photos[0].getUrl({maxHeight:50})}}):t._e(),e.photos[1]?a("img",{attrs:{src:e.photos[1].getUrl({maxHeight:50})}}):t._e(),e.photos[2]?a("img",{attrs:{src:e.photos[2].getUrl({maxHeight:50})}}):t._e()]):t._e()]),a("td",[!0===t.isPlaceUsed(e.placeId)?a("span",{staticStyle:{color:"#CCC"}},[t._v("Used")]):t._e(),!1===t.isPlaceUsed(e.placeId)?a("button",{staticClass:"btn btn-sm btn-danger",on:{click:function(a){t.deletePlace(e.placeId)}}},[t._v("Delete")]):t._e()])])}))]):t._e()]):t._e()])},st=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",[t._v("Destinations used")]),a("td")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",[a("td",[t._v("Last updater")]),a("td")])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("strong",[a("em",[t._v("New Plan")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("strong",[a("em",[t._v("New Destination")])])}];function ot(t){a("0xcP")}var lt=!1,ct=ot,ut=null,dt=null,pt=Object(d["a"])(it,rt,st,lt,ct,ut,dt),ht=pt.exports,mt={name:"trip-plan",computed:s()({},Object(i["c"])(["showPlanDialog","currentPlan","trip"])),methods:s()({},Object(i["b"])(["setShowPlanDialog","setCurrentPlan"]),{save:function(){var t=this.currentPlan.itineraries.map(function(t){return{placeId:t.placeId,duration:t.duration}}),e=this.currentPlan.travels.map(function(t){return{from:t.from,to:t.to,duration:t.duration}});if(null===this.currentPlan.mode){var a={name:this.currentPlan.name,start:0,end:0,itineraries:t,travels:e};this.trip.addPlan(a),this.currentPlan.mode=null}this.trip.sanitize(),x.writeDB("/Trip/"+this.trip.name,this.trip.toObj()),this.setShowPlanDialog(!1)},cancel:function(){this.setShowPlanDialog(!1)},getTripPlaces:function(){return this.trip.places},findPlace:function(t){return this.trip.findPlace(t)},addRow:function(){this.currentPlan.itineraries.push({placeId:"",duration:0});var t=this.currentPlan.itineraries.length;t>1&&this.currentPlan.travels.push({from:"",to:"",duration:0})}}),watch:{"currentPlan.itineraries":function(){if(!_.isNil(this.currentPlan))for(var t=this.currentPlan,e=t.itineraries,a=0;a<t.travels.length;a++){var n=t.travels[a];n.from=e[a].placeId,n.to=e[a+1].placeId}}}},ft=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal",class:{show:t.showPlanDialog},staticStyle:{opacity:"0.9"}},[a("div",{staticClass:"modal-dialog modal-lg"},[t.currentPlan?a("div",{staticClass:"modal-content"},[t._m(0),a("div",{staticClass:"modal-body"},[a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentPlan.name,expression:"currentPlan.name"}],attrs:{type:"text",placeholder:"Plan name"},domProps:{value:t.currentPlan.name},on:{input:function(e){e.target.composing||t.$set(t.currentPlan,"name",e.target.value)}}})]),a("br"),a("div",{staticStyle:{display:"flex","flex-direction":"row"}},[a("div",{staticStyle:{"padding-left":"0rem","max-height":"15rem","overflow-y":"scroll",flex:"1",display:"flex","flex-direction":"row"}},[a("div",[t._v(" \n              Destinations\n              "),a("table",{staticClass:"table"},[t._m(1),a("tbody",t._l(t.currentPlan.itineraries,function(e,n){return t.currentPlan.itineraries.length>0?a("tr",{key:n},[a("td",[a("button",[t._v("-")]),a("button",{on:{click:function(e){t.addRow()}}},[t._v("+")])]),a("td",[a("select",{directives:[{name:"model",rawName:"v-model",value:e.placeId,expression:"item.placeId"}],on:{change:function(a){var n=Array.prototype.filter.call(a.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(e,"placeId",a.target.multiple?n:n[0])}}},[a("option",{attrs:{disabled:"",value:""}},[t._v("Destinations")]),t._l(t.getTripPlaces(),function(e){return a("option",{key:e.placeId,domProps:{value:e.placeId}},[t._v(t._s(e.name))])})],2)]),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.duration,expression:"item.duration"}],attrs:{type:"text",size:"4"},domProps:{value:e.duration},on:{input:function(a){a.target.composing||t.$set(e,"duration",a.target.value)}}})]),t._m(2,!0)]):t._e()}))])]),a("div",{staticStyle:{"margin-left":"1rem"}},[t._v("\n              On Route \n              "),a("table",{staticClass:"table"},[t._m(3),a("tbody",t._l(t.currentPlan.travels,function(e,n){return a("tr",{key:n},[a("td",[a("span",[t._v(t._s(t.findPlace(e.from).name)+" > "+t._s(t.findPlace(e.to).name))])]),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.duration,expression:"travel.duration"}],attrs:{type:"text",size:"4"},domProps:{value:e.duration},on:{input:function(a){a.target.composing||t.$set(e,"duration",a.target.value)}}})])])}))])])])])]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){t.save()}}},[t._v("Save")]),a("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){t.cancel()}}},[t._v("Cancel")])])]):t._e()])])},vt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("strong",[t._v("Add/Edit Plan")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("th"),a("th",[t._v("Destination")]),a("th",[t._v("Duration")]),a("th",[t._v("Notes")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("td",[a("textarea",{attrs:{rows:"1"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("th",[t._v("Route")]),a("th",[t._v("Duration")])])}],gt=!1,_t=null,wt=null,bt=null,yt=Object(d["a"])(mt,ft,vt,gt,_t,wt,bt),Pt=yt.exports,St=function(){function t(e){y()(this,t),this.map=e,this.mapObjects=[],this.usePathIcon=!0}return S()(t,[{key:"refresh",value:function(t){this.mapObjects.forEach(function(t){t.setMap(null)}),0!==t.plans.length&&(this.renderPlans(t),this.renderPlaces(t))}},{key:"renderPlans",value:function(t){var e=this,a=["#FF0000","#CC0099","#448822","#884488","#336699"],n={path:"M 0,-0.2 0,0.2",strokeOpacity:.5,scale:4};t.plans.forEach(function(i,r){var s=[];i.itineraries.forEach(function(e){var a=_.find(t.places,function(t){return t.placeId===e.placeId}),n=a.geometry.location.lat(),i=a.geometry.location.lng();s.push({lat:n,lng:i})});var o=null;o=new google.maps.Polyline({path:s,geodesic:!0,strokeColor:a[r],strokeOpacity:.8,strokeWeight:0,icons:[{icon:n,offset:"0",repeat:"10px"}]}),!1===e.usePathIcon&&(o=new google.maps.Polyline({path:s,geodesic:!0,strokeColor:a[r],strokeOpacity:.8,strokeWeight:2})),o.setMap(e.map),e.mapObjects.push(o)})}},{key:"renderPlaces",value:function(t){var e=this,a=new google.maps.LatLngBounds;t.places.forEach(function(t){var n=t.geometry.location.lat(),i=t.geometry.location.lng(),r=new google.maps.Circle({map:e.map,center:{lat:n,lng:i},strokeColor:"#04f",strokeWeight:2,fillColor:"#04f",radius:25e3});e.mapObjects.push(r),a.extend(t.geometry.location)}),this.map.fitBounds(a)}}]),t}();function Dt(t,e){return"translate("+t+","+e+")"}var Ct=function(){function t(e){y()(this,t);var a=e.node().getBoundingClientRect();this.svg=e.append("svg").attr("width","100%").attr("height","100%").attr("viewBox","0 0 "+a.width+" "+a.height),this.margin=5,this.w=a.width-2*this.margin,this.h=a.height-2*this.margin,this.chart=this.svg.append("g").attr("transform",Dt(this.margin,this.margin))}return S()(t,[{key:"setClickFn",value:function(t){this.clickFn=t}},{key:"render",value:function(t){var e=this,a=this.chart;if(a.selectAll("*").remove(),0!==t.plans.length){var n=t.maxLength(),i=n+5,r=this.w/i,s=20,l=o["b"]().range(o["c"]).domain(t.places.map(function(t){return t.placeId})),c=0;while(1){if(c>n)break;a.append("rect").attr("x",70+c*r).attr("y",0).attr("width",1).attr("height",100).attr("stroke","none").attr("fill","#BBB"),a.append("text").attr("x",70+c*r).attr("y",115).style("text-anchor","middle").text(c),c+=1}t.plans.forEach(function(n,i){var c=t.listPlan(n),u=70,d=a.append("g").datum(n),p=e.clickFn;d.on("click",function(t){p&&p(t)}),d.append("text").attr("x",u-10).attr("y",25+i*(s+2)).style("text-anchor","end").text(n.name),c.forEach(function(t){var e=t.data.duration,a=t.type;if("travels"===a)d.append("rect").attr("x",u+1).attr("y",17+i*(s+5)).attr("width",e*r).attr("height",6).style("fill","#aaa");else{var n=l(t.data.placeId);d.append("rect").attr("x",u).attr("y",10+i*(s+5)).attr("rx",5).attr("width",e*r).attr("height",s).style("fill",n).style("stroke-width",2).style("stroke",o["a"](n).darker())}u+=e*r})})}}}]),t}(),xt={name:"app",data:function(){return{mapLayer:null,graph:null}},components:{TripHeader:w,TripNew:$,TripLoad:J,TripDest:et,TripSummary:ht,TripPlan:Pt},mounted:function(){var t=new google.maps.LatLng(51,0),e=new google.maps.Map(document.getElementById("googleMap"),{center:t,zoom:5,mapTypeControlOptions:{mapTypeIds:[]},streetViewControl:!1}),a=new google.maps.places.AutocompleteService,n=new google.maps.places.PlacesService(e);this.graph=new Ct(o["d"]("#graph")),this.mapLayer=new St(e),this.setPlaceService(n),this.setAutocompleteService(a)},computed:s()({},Object(i["c"])(["trip"])),watch:{trip:function(){this.mapLayer.refresh(this.trip),this.graph.render(this.trip)}},methods:s()({},Object(i["b"])(["setPlaceService","setAutocompleteService"]))},kt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("trip-header"),a("div",{staticClass:"flex-row"},[a("trip-summary"),t._m(0)],1),a("trip-new"),a("trip-load"),a("trip-dest"),a("trip-plan")],1)},Tt=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{width:"50%"}},[a("div",{staticClass:"todo",staticStyle:{height:"20rem",width:"100%"},attrs:{id:"googleMap"}}),a("div",{staticClass:"flex-column"},[a("div",[t._v("Plans Timeline")]),a("div",{staticStyle:{width:"100%","min-height":"8rem"},attrs:{id:"graph"}})])])}];function It(t){a("+VGo")}var Ot=!1,Et=It,Nt=null,jt=null,Lt=Object(d["a"])(xt,kt,Tt,Ot,Et,Nt,jt),$t=Lt.exports,At=function(){function t(){y()(this,t)}return S()(t,null,[{key:"mockTrip",value:function(){return{name:"Test trip",places:[],plans:[],updated:0}}},{key:"mockLoggedInUser",value:function(){return{name:"User Alpha",loggedIn:!0}}},{key:"mockLoggedOutUser",value:function(){return{name:"",loggedIn:!1}}}]),t}();n["a"].use(i["a"]);var Bt=new i["a"].Store({state:{user:At.mockLoggedInUser(),trip:new A,placeService:null,autocompleteService:null,searchStr:"",currentPlan:null,currentPlanIdx:-1,showNewTripDialog:!1,showLoadTripDialog:!1,showPlanDialog:!1,showDestDialog:!1},getters:{user:function(t){return null===t.user?{name:null,loggedIn:!1}:{name:t.user.name,loggedIn:!0}},trip:function(t){return t.trip},searchStr:function(t){return t.searchStr},showNewTripDialog:function(t){return t.showNewTripDialog},showLoadTripDialog:function(t){return t.showLoadTripDialog},showPlanDialog:function(t){return t.showPlanDialog},showDestDialog:function(t){return t.showDestDialog},autocompleteService:function(t){return t.autocompleteService},currentPlan:function(t){return t.currentPlan},currentPlanIdx:function(t){return t.currentPlanIdx}},actions:{setSearchStr:function(t,e){var a=t.commit;a("setSearchStr",e)},setShowNewTripDialog:function(t,e){var a=t.commit;a("setShowNewTripDialog",e)},setShowLoadTripDialog:function(t,e){var a=t.commit;console.log("setShowLoadTripDialog",e),a("setShowLoadTripDialog",e)},setShowPlanDialog:function(t,e){var a=t.commit,n=t.state;!0===e&&null===n.currentPlan&&a("setCurrentPlan",{name:"",travels:[],itineraries:[{placeId:"",duration:1}],mode:null}),a("setShowPlanDialog",e)},setShowDestDialog:function(t,e){var a=t.commit;a("setShowDestDialog",e)},setTrip:function(t,e){var a=t.commit;a("setTrip",e)},setCurrentPlan:function(t,e){var a=t.commit;a("setCurrentPlan",e)},setCurrentPlanIdx:function(t,e){var a=t.commit;a("setCurrentPlanIdx",e)},setPlaceService:function(t,e){var a=t.commit;a("setPlaceService",e)},setAutocompleteService:function(t,e){var a=t.commit;a("setAutocompleteService",e)},getPlaceDetail:function(t,e){var a=t.state;return new Promise(function(t,n){a.placeService.getDetails({placeId:e,types:["(cities)"]},function(e,a){a==google.maps.places.PlacesServiceStatus.OK?(e.placeId=e.place_id,t(e)):n(null)})})}},mutations:{setSearchStr:function(t,e){t.searchStr=e},setShowNewTripDialog:function(t,e){t.showNewTripDialog=e},setShowLoadTripDialog:function(t,e){console.log("???",e),t.showLoadTripDialog=e},setShowPlanDialog:function(t,e){t.showPlanDialog=e},setShowDestDialog:function(t,e){t.showDestDialog=e},setCurrentPlan:function(t,e){t.currentPlan=e},setCurrentPlanIdx:function(t,e){t.currentPlanIdx=e},setTrip:function(t,e){t.trip=nt.a.cloneDeep(e)},setPlaceService:function(t,e){t.placeService=e},setAutocompleteService:function(t,e){t.autocompleteService=e}}});n["a"].config.productionTip=!1,new n["a"]({render:function(t){return t($t)},store:Bt}).$mount("#app")}},[0]);
//# sourceMappingURL=app.1112c15c.js.map